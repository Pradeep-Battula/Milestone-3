Objective:
Calculate overall AQI for the city based on pollutant concentrations and predefined thresholds.

Implementation:

Function simple_aqi(val, pol) computes AQI for each pollutant.

Overall AQI is the maximum AQI across all pollutants.

Severity colors for AQI visualization: Green → Good, Yellow → Satisfactory, Orange → Moderate, Red → Poor, Purple → Very Poor, Maroon → Severe.

def simple_aqi(val, pol):
    thresholds = {'PM2.5': 60, 'PM10': 100, 'NO2': 80, 'SO2': 80, 'O3': 100,
                  'CO': 10, 'NH3': 400, 'NO': 80, 'NOx': 100}
    return (val / thresholds.get(pol, 100)) * 100

aqi_values = [simple_aqi(v, pol) for pol, v in latest_pollutants.items()]
overall_aqi = int(max(aqi_values))

Visualization (Donut Chart):

fig, ax = plt.subplots(figsize=(4,4), facecolor='none')
wedges, texts, autotexts = ax.pie(
    latest_pollutants, labels=latest_pollutants.index,
    autopct="%1.1f%%", startangle=140,
    colors=plt.cm.tab20.colors[:len(latest_pollutants)],
    wedgeprops={'width':0.4, 'edgecolor':'w'},
    pctdistance=0.8
)
ax.text(0, 0, f"AQI\n{overall_aqi}", ha='center', va='center',
        fontsize=16, fontweight='bold', color='red')
st.pyplot(fig, clear_figure=True)
